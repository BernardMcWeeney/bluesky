---
import "../styles/global.css";

interface Props {
  title: string;
  description?: string;
}

const { title, description = "Bluesky Software â€” a complete website, mobile app, and integrated module platform for businesses, clubs, and organizations. It's better over here." } = Astro.props;

const navItems = [
  { href: "/", label: "Home" },
  { href: "/about", label: "About" },
  { href: "/services", label: "Services" },
  { href: "/blog", label: "Blog" },
  { href: "/contact", label: "Contact" }
];

const cleanedPath = Astro.url.pathname.replace(/\/+$/, "") || "/";
const isActive = (href: string) =>
  href === "/" ? cleanedPath === "/" : cleanedPath === href || cleanedPath.startsWith(`${href}/`);
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#0ea5e9" />
    <meta name="generator" content={Astro.generator} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>{title}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=Outfit:wght@500;600;700;800&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="site-wrap">
      <!-- Animated floating clouds -->
      <div class="clouds-layer" aria-hidden="true">
        <div class="cloud cloud-1"></div>
        <div class="cloud cloud-2"></div>
        <div class="cloud cloud-3"></div>
        <div class="cloud cloud-4"></div>
        <div class="cloud cloud-5"></div>
        <div class="cloud cloud-6"></div>
        <div class="cloud cloud-7"></div>
        <div class="cloud cloud-8"></div>
      </div>

      <!-- Atmospheric gradient blobs -->
      <div class="bg-atmosphere" aria-hidden="true">
        <div class="sky-haze one"></div>
        <div class="sky-haze two"></div>
        <div class="sky-haze three"></div>
        <div class="sky-haze four"></div>
      </div>

      <!-- Navigation -->
      <header class="topbar">
        <div class="container">
          <div class="topbar-shell fade-in">
            <a class="brand" href="/">
              <span class="brand-icon" aria-hidden="true"></span>
              <span class="brand-text">
                <strong>Bluesky</strong>
                <span>It's better over here</span>
              </span>
            </a>

            <button class="menu-toggle" aria-label="Toggle navigation" aria-expanded="false">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round">
                <line x1="3" y1="6" x2="21" y2="6" />
                <line x1="3" y1="12" x2="21" y2="12" />
                <line x1="3" y1="18" x2="21" y2="18" />
              </svg>
            </button>

            <nav class="nav" aria-label="Primary">
              {
                navItems.map((item) => (
                  <a class={isActive(item.href) ? "active" : ""} href={item.href}>{item.label}</a>
                ))
              }
            </nav>
          </div>
        </div>
      </header>

      <!-- Page content -->
      <main>
        <slot />
      </main>

      <!-- Footer -->
      <footer class="footer">
        <div class="container">
          <div class="footer-shell">
            <div class="footer-top">
              <div class="footer-brand">
                <a class="brand" href="/">
                  <span class="brand-icon" aria-hidden="true"></span>
                  <span class="brand-text">
                    <strong>Bluesky</strong>
                    <span>It's better over here</span>
                  </span>
                </a>
                <p>
                  A complete website, mobile app, and integrated module platform.
                  Easy, breezy, and built to scale.
                </p>
              </div>
              <div class="footer-nav">
                <div class="footer-col">
                  <h4>Platform</h4>
                  <a href="/services">Services</a>
                  <a href="/about">About us</a>
                  <a href="/blog">Journal</a>
                  <a href="/contact">Contact</a>
                </div>
                <div class="footer-col">
                  <h4>Modules</h4>
                  <a href="/services">Forms</a>
                  <a href="/services">Email subscribers</a>
                  <a href="/services">Events & calendar</a>
                  <a href="/services">Social connector</a>
                </div>
              </div>
            </div>
            <div class="footer-bottom">
              <p>&copy; {new Date().getFullYear()} Bluesky Software</p>
              <p>Designed under blue skies.</p>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <!-- Mobile menu toggle script -->
    <script>
      const toggle = document.querySelector('.menu-toggle');
      const nav = document.querySelector('.nav');
      if (toggle && nav) {
        toggle.addEventListener('click', () => {
          const isOpen = nav.classList.toggle('open');
          toggle.setAttribute('aria-expanded', String(isOpen));
        });
      }

      // Scroll-triggered reveal animations
      const reveals = document.querySelectorAll('.reveal');
      if (reveals.length > 0) {
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                entry.target.classList.add('visible');
                observer.unobserve(entry.target);
              }
            });
          },
          { threshold: 0.12 }
        );
        reveals.forEach((el) => observer.observe(el));
      }
    </script>
  </body>
</html>
